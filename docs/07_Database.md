## 7 –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –¥–∞–Ω–Ω—ã–º

### 7.1 –§–∏–∑–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

![3–ù–§ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](docs/dbms/ER.puml)

–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

- Users
- Sessions
- Analysis_Results
- Chunks
- Feedbacks
- Risks
- Risk_Categories
- Jurisdictions
- Document_Types
- Tariff
- Payments
- Payments_Types
- Rate_Limit_Log

### 7.2 –°–ª–æ–≤–∞—Ä—å –¥–∞–Ω–Ω—ã—Ö —Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```plantuml
@startuml
!include docs/dbms/ER.puml
@enduml
`` `


–°–ª–æ–≤–∞—Ä—å —Å–æ–¥–µ—Ä–∂–∏—Ç –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ª–µ–π –¥–ª—è —Å–ª–µ–¥—É—é—â–∏—Ö —Ç–∞–±–ª–∏—Ü:

1. **Users (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)**
2. **Sessions (–°–µ—Å—Å–∏–∏ –∞–Ω–∞–ª–∏–∑–∞)**
3. **Analysis_Results (–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞)**
4. **Chunks (–ß–∞–Ω–∫–∏)**
5. **Feedbacks (–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å)**
6. **Risks (–†–∏—Å–∫–∏)**
7. **Risk_Categories (–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–∏—Å–∫–æ–≤)**
8. **Jurisdictions (–Æ—Ä–∏—Å–¥–∏–∫—Ü–∏–∏)**
9. **Document_Types (–¢–∏–ø—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤)**
10. **Tariff (–¢–∞—Ä–∏—Ñ)**
11. **Payments (–ü–ª–∞—Ç–µ–∂–∏)**
12. **Payments_Types (–¢–∏–ø—ã –ø–ª–∞—Ç–µ–∂–µ–π)**
13. **Rate_Limit_Log (–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤)**

### 7.3 –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

#### 7.3.1 –°–±–æ—Ä —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

- –•—Ä–∞–Ω–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π —Ä–∏—Å–∫–æ–≤
- –ë—ã—Å—Ç—Ä—ã–π —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ (< 1 —Å–µ–∫)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
- –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å –¥–æ 100k+ –≤–µ–∫—Ç–æ—Ä–æ–≤

#### 7.3.2 –ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö

**[–ò–ó–û–ë–†–ê–ñ–ï–ù–ò–ï: –¢–∞–±–ª–∏—Ü–∞ —Å—Ö–µ–º—ã Vector_documents]**

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—è –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:

- document_vector_id (UUID)
- chunk_id (INTEGER)
- session_id (INTEGER)
- user_id (INTEGER)
- embedding (DenseVector 768-1024)
- embedding_model (VARCHAR)
- chunk_text (TEXT)
- metadata (JSON)
- document_type (VARCHAR)
- jurisdiction (VARCHAR)
- created_at (TIMESTAMP)

#### 7.3.3 –í—ã–±–æ—Ä —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è

- **HNSW-–∏–Ω–¥–µ–∫—Å** –¥–ª—è embedding (–±—ã—Å—Ç—Ä—ã–π –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–∏—Å–∫)
- **BTree-–∏–Ω–¥–µ–∫—Å** –¥–ª—è chunk_id, session_id, user_id
- **Full-text-–∏–Ω–¥–µ–∫—Å** –¥–ª—è chunk_text (–ø–æ–ª–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–æ–∏—Å–∫)

#### 7.3.4 –†–∞—Å—á—ë—Ç —ë–º–∫–æ—Å—Ç–∏ –∏ —Ä–µ—Å—É—Ä—Å–æ–≤

- –†–∞–∑–º–µ—Ä –æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ (768 –∏–∑–º–µ—Ä–µ–Ω–∏–π, float32): ~3 –ö–ë
- 100,000 –≤–µ–∫—Ç–æ—Ä–æ–≤: ~300 –ú–ë
- –° —É—á–µ—Ç–æ–º –∏–Ω–¥–µ–∫—Å–æ–≤ –∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö: ~1 –ì–ë
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è RAM –¥–ª—è Qdrant: 4 –ì–ë

## 8 –ü—Ä–æ—Ü–µ—Å—Å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### MVP

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ –∂–∏–∑–Ω–µ—Å–ø–æ—Å–æ–±–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç:

1. Telegram-–±–æ—Ç —Å –±–∞–∑–æ–≤—ã–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º
2. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ PDF –∏ TXT —Ñ–∞–π–ª–æ–≤
3. –ê–Ω–∞–ª–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Ä–æ—Å—Å–∏–π—Å–∫–æ–π —é—Ä–∏—Å–¥–∏–∫—Ü–∏–∏
4. –ë–∞–∑–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ä–∏—Å–∫–æ–≤ (üî¥üü°üü¢)
5. –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π —Ç–∞—Ä–∏—Ñ (3 –∞–Ω–∞–ª–∏–∑–∞)
6. –¢—Ä–∞–Ω–∑–∏—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

### –í–æ–ø—Ä–æ—Å—ã –∫ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏

- –¶–µ–Ω–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è –¥–ª—è —Ç–∞—Ä–∏—Ñ–æ–≤ (Free, Pro, Pro+)
- –ú–æ–¥–µ–ª—å –ø–æ–¥–ø–∏—Å–∫–∏ vs –æ–ø–ª–∞—Ç–∞ –∑–∞ –∞–Ω–∞–ª–∏–∑
- B2B API –¥–ª—è –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
- –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã

### –í–æ–ø—Ä–æ—Å—ã –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

- –í—ã–±–æ—Ä –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ LLM (–ª–æ–∫–∞–ª—å–Ω—ã–π vs –æ–±–ª–∞—á–Ω—ã–π)
- –ò–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è (cloud provider)
- –°—Ç—Ä–∞—Ç–µ–≥–∏—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç–∏–Ω–≥
- CI/CD –ø—Ä–æ—Ü–µ—Å—Å—ã
